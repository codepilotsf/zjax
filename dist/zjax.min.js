(()=>{var g=["GET","POST","PUT","PATCH","DELETE"],w=["outer","inner"],b=["outer","inner","before","after","prepend","append","none","delete"],T=document.startViewTransition!==void 0,f=["id","z-swap","z-action","z-confirm","z-active","z-validate"];var p=S();function S(){return{debug:!1,transitions:!0,zjaxActions:{},userActions:{},actions:function(t,e){let n=e?t:null;if(n==="zjax")throw new Error("'zjax' is a reserved actions namespace");let r=e||t,o;n?(this.userActions[n]={},o=this.userActions[n]):o=this.userActions,Object.keys(r).forEach(function(i){let s=r[i];o[i]=s})}}}function c(){window.zjax.debug&&console.log("ZJAX DEBUG:",...arguments)}async function l(t){let e=R(t,"[z-swap]");c(`Found ${e.length} z-swap nodes in ${d(t)}`);for(let n of e)try{let r=n.getAttribute("z-swap"),o=O(r,n),i=j(o,n);L(o.trigger,i,n),q(o.trigger,i,n),o.trigger==="load"&&n.dispatchEvent(new Event("load")),c(`Added z-swap for '${o.trigger}' events to ${d(n)}`)}catch(r){console.error(`ZJAX ERROR \u2013 Unable to parse z-swap: ${r.message}
`,n,r.stack)}}function O(t,e){let r=I(t).split(/\s/);if(r.length<1||r.length>4)throw new Error("Must have between 1 and 4 parts separated by spaces.");let o={},i=[];for(;r.length>0;){let s=r.shift(),a=D(s);a?o[a[0]]=a[1]:i.push(s)}if(o.trigger==="@submit"&&e.tagName!=="FORM")throw new Error("@submit trigger is only available on <FORM> elements");if(o.swaps=$(i.join(" ")),o.trigger||(o.trigger=e.tagName==="FORM"?"submit":"click"),o.method||(o.method=e.tagName==="FORM"?"POST":"GET"),!o.endpoint)if(e.tagName==="FORM")o.endpoint=e.action;else if(e.tagName==="A")o.endpoint=e.href;else throw new Error("No endpoint inferrable or specified");return o}function D(t){if(t.startsWith("@"))return["trigger",t.substr(1)];if(g.includes(t.toUpperCase()))return["method",t.toUpperCase()];if(/^(\/.*|\.\/.*|https?:\/\/.*|\.)$/.test(t))return["endpoint",t]}function d(t){return t instanceof Document?"#document":"<"+t.tagName.toLowerCase()+(t.id?"#"+t.id:"")+">"}function R(t,e){let n=[];return n.push(...t.querySelectorAll(e)),!(t instanceof Document)&&t.matches(e)&&n.push(t),n}function $(t){let e=[];return t.split(",").forEach(function(n){let r={},o=n.split("->")||[],i=o.pop(),[s,a]=i.split("|"),h=o[0]||"",[x,m]=h&&h.split("|");if(r.response=x||s,r.target=s,r.responseType=m&&m.trim()||"outer",r.swapType=a&&a.trim()||"outer",r.responseType&&!w.includes(r.responseType))throw new Error(`Invalid swap type: ${r.responseType}`);if(r.swapType&&!b.includes(r.swapType))throw new Error(`Invalid swap type: ${r.swapType}`);if(r.response==="*"&&r.responseType!=="outer")throw new Error('Wild card "*" can notbe piped to a Response Type');if(r.target==="*"&&r.swapType!=="outer")throw new Error('Wild card "*" can not be piped to a Swap Type');e.push(r)}),e}function j(t,e){return async function(n){n.preventDefault(),n.stopPropagation(),c("z-swap triggered for",t);try{let r=await C(t.method,t.endpoint);t.swaps.forEach(function(o){let[i,s]=P(r,o);c("Parsing incoming response for z-swaps"),i&&l(i),T&&p.transitions?document.startViewTransition(()=>{y(s,i,o.swapType,o.responseType)}):y(s,i,o.swapType,o.responseType)})}catch(r){console.error(`ZJAX ERROR \u2013 Unable to execute z-swap function: ${r.message}
`,e,r.stack)}}}async function C(t,e){let n=await fetch(e,{method:t,body:null});if(!n.ok)throw new Error(`${n.status} ${n.statusText} for ${e}`);let r=new DOMParser().parseFromString(await n.text(),"text/html");return c(`z-swap response from ${e} received and parsed`),r}function P(t,e){let n,r;if(e.target==="*"){if(n=document.querySelector("body"),!n)throw new Error("Unable to find body element in local DOM to swap into")}else n=document.querySelector(e.target);if(r=e.response==="*"?t:t.querySelector(e.response),!n&&e.swapType!=="none")throw new Error(`Target node '${e.target}' does not exist in local DOM`);if(!r&&e.swapType!=="none"&&e.swapType!=="delete")throw new Error(`Source node ${e.response} does not exist in response DOM`);return[r,n]}function F(t,e){let n={},r=N(t,"[id]");for(let o of r)if(E(e,`[id="${o.id}"]`)){let s=A(o),a=A(e);z(e),v(e,s),n[o.id]=a}return[e,n]}function y(t,e,n,r){e=r==="inner"?e.childNodes:e;let o;[e,o]=F(t,e);let i=U(e);if(n==="outer"){let s=t.parentNode;i.forEach(a=>{s.insertBefore(a,t)}),s.removeChild(t),u(e,o);return}if(n==="inner"){t.textContent="",i.forEach(s=>{t.appendChild(s)}),u(e,o);return}if(n==="before"){i.forEach(s=>{t.parentNode.insertBefore(s,t)}),u(e,o);return}if(n==="after"){let s=t.parentNode;referenceNodeToAppendTo=t,i.forEach(a=>{a===s.lastChild?s.appendChild(a):s.insertBefore(a,referenceNodeToAppendTo.nextSibling),referenceNodeToAppendTo=a}),u(e,o);return}if(n==="prepend"){let s=t.firstChild;i.forEach(a=>{s?t.insertBefore(a,s):t.appendChild(a)}),u(e,o);return}if(n==="append"){i.forEach(s=>{t.appendChild(s)}),u(e,o);return}if(n==="delete"){t.remove();return}}function E(t,e){return t.matches(e)?t:t.querySelector(e)}function N(t,e){let n=[];return t.matches(e)&&n.push(t),n.push(...t.querySelectorAll(e)),n}function A(t){let e=[];for(let n of Array.from(t.attributes).filter(r=>!f.includes(r.name)))e.push([n.name,n.value]);return e}function v(t,e){for(let[n,r]of e)t.setAttribute(n,r)}function z(t){Array.from(t.attributes).forEach(e=>{f.includes(e.name)||t.removeAttribute(e.name)})}function u(t,e){setTimeout(()=>{for(let[n,r]of Object.entries(e)){let o=E(t,`[id="${n}"]`);o&&(z(o),v(o,r))}},20)}function U(t){if(t instanceof Document){let e=t.querySelector("html");if(e)return Array.from(e.childNodes);let n=document.createDocumentFragment();for(let r of t.childNodes)n.appendChild(r);return Array.from(n.childNodes)}return t instanceof NodeList||Array.isArray(t)?Array.from(t):[t]}function L(t,e,n){n.addEventListener(t,e)}function q(t,e,n){let r=new MutationObserver(o=>{for(let i of o)for(let s of i.removedNodes)if(s===n||s.contains(n)){n.removeEventListener(t,e),p.debug&&c(`Removing event listener for ${d(n)} (no longer in DOM)`),r.disconnect();return}});r.observe(document.body,{childList:!0,subtree:!0})}function I(t){return t.replace(/\s*,\s*/g,",")}window.zjax=p;addEventListener("DOMContentLoaded",function(){c("Parsing DOM"),l(document)});})();
