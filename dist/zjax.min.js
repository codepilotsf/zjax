(()=>{var O=Object.defineProperty;var x=(e,t)=>{for(var n in t)O(e,n,{get:t[n],enumerable:!0})};var f={};x(f,{attrsToNotFreeze:()=>N,globalTriggerModifiers:()=>P,httpMethods:()=>$,isVTSupported:()=>k,keyboardEvents:()=>L,keyboardTriggerModifiers:()=>Z,mouseEvents:()=>F,mouseTriggerModifiers:()=>C,responseTypes:()=>j,swapTypes:()=>D,timerTriggerModifiers:()=>R});var $=["GET","POST","PUT","PATCH","DELETE"],j=["outer","inner"],D=["outer","inner","before","after","prepend","append","none","delete"],k=document.startViewTransition!==void 0,N=["id","z-swap","z-action","z-confirm","z-active","z-validate"],P=["document","window","once","prevent","stop"],R=["delay","debounce"],F=["click","auxclick","dblclick","mousedown","mouseup","mouseover","mousemove","mouseout","mouseenter","mouseleave","context"],C=["outside","ctrl","shift","alt","meta"],L=["keydown","keyup"],Z=["keyName","shift","ctrl","alt","meta"];var u={};x(u,{attachMutationObserver:()=>X,debounce:()=>V,getDocumentOrWindow:()=>I,getMatchingNodes:()=>U,getStatements:()=>q,prettyNodeName:()=>v,processDelayModifiers:()=>J,processKeyboardModifiers:()=>K,processMouseModifiers:()=>W,processOnceModifiers:()=>B,processOutsideModifiers:()=>G,processPreventOrStopModifiers:()=>H});function U(e,t){let n=[];return n.push(...e.querySelectorAll(t)),!(e instanceof Document)&&e.matches(t)&&n.push(e),n}function q(e,t){let n=[],r=e.split(/,\s*(?=@)/);for(let s of r){let o=s.match(/^(@\w+[\w\-\.]+|@\[[\w\-\.\,]+\])?(.*)/),i=o[1]?o[1].replace(/[@\[\]\s]+/,""):"",a=o[2]?o[2].trim():"",c=_(i,t);for(let{trigger:d,modifiers:m}of c)n.push({trigger:d,modifiers:m,handlerString:a})}return n}function I(e){return e.document?document:e.window||e.outside?window:null}function K({trigger:e,modifiers:t,event:n}){return!(f.keyboardEvents.includes(e)&&(t.shift&&!n.shiftKey||t.ctrl&&!n.ctrlKey||t.alt&&!n.altKey||t.meta&&!n.metaKey||t.keyName&&n.key!==t.keyName))}function W({trigger:e,modifiers:t,event:n}){return!(f.mouseEvents.includes(e)&&(t.shift&&!n.shiftKey||t.ctrl&&!n.ctrlKey||t.alt&&!n.altKey||t.meta&&!n.metaKey))}function G({modifiers:e,node:t,event:n}){return!(e.outside&&t.contains(n.target))}function B({modifiers:e,node:t}){return t.hasFiredOnce?!1:(e.once&&(t.hasFiredOnce=!0),!0)}function H({modifiers:e,event:t}){return e.prevent&&t.preventDefault(),e.stop&&t.stopPropagation(),!0}async function J({modifiers:e}){return e.delay&&await new Promise(t=>setTimeout(t,e.delay)),!0}function v(e){return e instanceof Document?"#document":"<"+e.tagName.toLowerCase()+(e.id?"#"+e.id:"")+">"}function V(e,t){let n,r=[];return function(...s){clearTimeout(n);let o=new Promise(i=>{r.push(i)});return n=setTimeout(async()=>{try{let i=await e.apply(this,s);r.forEach(a=>a(i)),r=[]}catch(i){r.forEach(a=>a(Promise.reject(i))),r=[]}},t),o}}function X(e,t,n){let r=new MutationObserver(s=>{for(let o of s)for(let i of o.removedNodes)if(i===n||i.contains(n)){n.removeEventListener(e,t),zjax.debug&&p(`Removing event listener for ${v(n)} (no longer in DOM)`),r.disconnect();return}});r.observe(document.body,{childList:!0,subtree:!0})}function _(e,t){if(!e)return t==="FORM"?[{trigger:"submit"}]:[{trigger:"click"}];let n=[];for(let r of e.split(","))n.push(Q(r));return n}function Q(e){let t=e.split("."),n=t.shift(),r=f.mouseEvents.includes(n),s=f.keyboardEvents.includes(n),o={},i=s?"keyName":null;for(let a of t){if(previousModifier=a,f.globalTriggerModifiers.includes(a)){o[a]=!0;continue}if(r&&f.mouseTriggerModifiers.includes(a)){o[a]=!0;continue}if(s&&f.keyboardTriggerModifiers.includes(a)){o[a]=!0;continue}if(s&&i==="keyName"){o[i]=a,i=null;continue}if(f.timerTriggerModifiers.includes(a)){i=a;continue}if(i&&f.timerTriggerModifiers.includes(i)){let c=a.match(/\d+s/),d=a.match(/\d+ms/);if(!c&&!d)throw new Error(`Invalid timer value: ${a}`);o[i]=c?parseInt(c[0])*1e3:parseInt(d[0]),i=null;continue}throw new Error(`Unknown trigger modifier in this context: ${a}`)}return{trigger:n,modifiers:o}}function b(){return{debug:!1,transitions:!0,zjaxActions:{},userActions:{},actions:function(e,t){let n=t?e:null;if(n==="zjax")throw new Error("'zjax' is a reserved actions namespace");let r=t||e,s;n?(this.userActions[n]={},s=this.userActions[n]):s=this.userActions;let o=Object.keys(r);for(let i of o){let a=r[i];s[i]=a}}}}function p(){window.zjax&&window.zjax.debug&&console.log("ZJAX DEBUG:",...arguments)}async function w(e){let t=u.getMatchingNodes(e,"[z-swap]");p(`Found ${t.length} z-swap nodes in ${u.prettyNodeName(e)}`);for(let n of t)try{let r=n.getAttribute("z-swap"),s=u.getStatements(r,n.tagName);for(let{trigger:o,modifiers:i,handlerString:a}of s){let c=Y(o,a,n),d=ne(c,n);c.trigger=c.trigger==="load"?"zjax:load":c.trigger,n.addEventListener(c.trigger,d),u.attachMutationObserver(c.trigger,d,n),o==="zjax:load"&&n.dispatchEvent(new CustomEvent("zjax:load")),p(`Added z-swap for '${c.trigger}' events to ${u.prettyNodeName(n)}`)}}catch(r){console.error(`ZJAX ERROR \u2013 Unable to parse z-swap: ${r.message}
`,n,r.stack)}}function Y(e,t,n){let s=ce(t).split(/\s/);if(s.length<1||s.length>4)throw new Error("Must have between 1 and 4 parts separated by spaces.");let o={trigger:e},i=[];for(;s.length>0;){let a=s.shift(),c=ee(a);c?o[c[0]]=c[1]:i.push(a)}if(o.swaps=te(i.join(" ")),o.method||(o.method=n.tagName==="FORM"?"POST":"GET"),!o.endpoint)if(n.tagName==="FORM")o.endpoint=n.action;else if(n.tagName==="A")o.endpoint=n.href;else throw new Error("No endpoint inferrable or specified");return o}function ee(e){if(f.httpMethods.includes(e.toUpperCase()))return["method",e.toUpperCase()];if(/^(\/.*|\.\/.*|https?:\/\/.*|\.)$/.test(e))return["endpoint",e]}function te(e){let t=[];for(let n of e.split(",")){let r={},s=n.split("->")||[],o=s.pop(),[i,a]=o.split("|"),c=s[0]||"",[d,m]=c?.split("|")||[null,null];if(r.response=d||i,r.target=i,r.responseType=m?.trim()||"outer",r.swapType=a?.trim()||"outer",r.responseType&&!f.responseTypes.includes(r.responseType))throw new Error(`Invalid swap type: ${r.responseType}`);if(r.swapType&&!f.swapTypes.includes(r.swapType))throw new Error(`Invalid swap type: ${r.swapType}`);if(r.response==="*"&&r.responseType!=="outer")throw new Error('Wild card "*" can not be piped to a Response Type');if(r.target==="*"&&r.swapType!=="outer")throw new Error('Wild card "*" can not be piped to a Swap Type');t.push(r)}return t}function ne(e,t){return async n=>{n.preventDefault(),n.stopPropagation();let r=t.tagName==="FORM"&&new FormData(n.target)||null;e.formData=r?ue(r):null,p("z-swap triggered for",e);try{let s=new CustomEvent("zjax:request",{detail:{node:t,trigger:e.trigger,method:e.method,endpoint:e.endpoint,formData:e.formData}});document.dispatchEvent(s);let o=await re(e.method,e.endpoint,e.formData),i=o.body||o.documentElement,a=new CustomEvent("zjax:response",{detail:{node:t,response:i.innerHTML.replace(/\n|\s{2,}/g,"")}});document.dispatchEvent(a);for(let d of e.swaps){let m=document.querySelector(d.target);m&&m.classList.add("zjax-swapping");let[l,y]=oe(o,d);p("Parsing incoming response for z-swaps"),l&&(w(l),h(l)),f.isVTSupported&&zjax.transitions?document.startViewTransition(()=>{E(y,l,d.swapType,d.responseType)}):E(y,l,d.swapType,d.responseType)}let c=new CustomEvent("zjax:swap",{detail:{node:t,swaps:e.swaps}});document.dispatchEvent(c)}catch(s){console.error(`ZJAX ERROR \u2013 Unable to execute z-swap function: ${s.message}
`,t,s.stack)}}}async function re(e,t,n){let r=await fetch(t,{method:e,body:n||null,headers:{"Content-Type":"application/x-www-form-urlencoded"}});if(!r.ok)throw new Error(`${r.status} ${r.statusText} for ${t}`);let s=new DOMParser().parseFromString(await r.text(),"text/html");return p(`z-swap response from ${t} received and parsed`),s}function oe(e,t){let n;if(t.target==="*"){if(n=document.querySelector("body"),!n)throw new Error("Unable to find body element in local DOM to swap into")}else n=document.querySelector(t.target);let r=t.response==="*"?e:e.querySelector(t.response);if(!n&&t.swapType!=="none")throw new Error(`Target node '${t.target}' does not exist in local DOM`);if(!r&&t.swapType!=="none"&&t.swapType!=="delete")throw new Error(`Source node ${t.response} does not exist in response DOM`);return[r,n]}function se(e,t){let n={},r=ie(e,"[id]");for(let s of r)if(M(t,`[id="${s.id}"]`)){let i=T(s),a=T(t);z(t),A(t,i),n[s.id]=a}return[t,n]}function E(e,t,n,r){t=r==="inner"?t.childNodes:t;let s;[t,s]=se(e,t);let o=ae(t);if(n==="outer"){let i=e.parentNode;for(let a of o)i.insertBefore(a,e);i.removeChild(e),g(t,s);return}if(n==="inner"){e.textContent="";for(let i of o)e.appendChild(i);g(t,s);return}if(n==="before"){for(let i of o)e.parentNode.insertBefore(i,e);g(t,s);return}if(n==="after"){let i=e.parentNode,a=e;for(let c of o)c===i.lastChild?i.appendChild(c):i.insertBefore(c,a.nextSibling),a=c;g(t,s);return}if(n==="prepend"){let i=e.firstChild;for(let a of o)i?e.insertBefore(a,i):e.appendChild(a);g(t,s);return}if(n==="append"){for(let i of o)e.appendChild(i);g(t,s);return}if(n==="delete"){e.remove();return}}function M(e,t){return e.matches(t)?e:e.querySelector(t)}function ie(e,t){let n=[];return e.matches(t)&&n.push(e),n.push(...e.querySelectorAll(t)),n}function T(e){let t=[];for(let n of Array.from(e.attributes).filter(r=>!f.attrsToNotFreeze.includes(r.name)))t.push([n.name,n.value]);return t}function A(e,t){for(let[n,r]of t)e.setAttribute(n,r)}function z(e){for(let t of Array.from(e.attributes))f.attrsToNotFreeze.includes(t.name)||e.removeAttribute(t.name)}async function g(e,t){setTimeout(()=>{for(let[r,s]of Object.entries(t)){let o=M(e,`[id="${r}"]`);o&&(z(o),A(o,s))}let n=Object.keys(t).map(r=>`#${r}`).join(", ");if(n){let r=new CustomEvent("zjax:settle",{detail:{node:e,elementIds:n}});document.dispatchEvent(r)}},20)}function ae(e){if(e instanceof Document){let t=e.querySelector("html");if(t)return Array.from(t.childNodes);let n=document.createDocumentFragment();for(let r of e.childNodes)n.appendChild(r);return Array.from(n.childNodes)}return e instanceof NodeList||Array.isArray(e)?Array.from(e):[e]}function ce(e){return e.replace(/\s*,\s*/g,",")}function ue(e){let t=new URLSearchParams;for(let[n,r]of e.entries())t.append(n,r);return t.toString()}function h(e){let t=u.getMatchingNodes(e,"[z-action]");p(`Found ${t.length} z-action nodes in ${u.prettyNodeName(e)}`);for(let n of t)try{let r=n.getAttribute("z-action"),s=u.getStatements(r,n.tagName);for(let{trigger:o,modifiers:i,handlerString:a}of s){let c=de(a,n);(u.getDocumentOrWindow(i)||n).addEventListener(o,async function(m){let l={trigger:o,modifiers:i,node:n,event:m};u.processKeyboardModifiers(l)&&u.processMouseModifiers(l)&&u.processOutsideModifiers(l)&&u.processPreventOrStopModifiers(l)&&await u.processDelayModifiers(l)&&(i.debounce?u.debounce(S,i.debounce)(n,m,c):S(n,m,c))}),u.attachMutationObserver(o,c,n),o==="load"&&n.dispatchEvent(new Event("load")),p(`Added z-action for '${o}' events to ${u.prettyNodeName(n)}`)}}catch(r){console.error(`ZJAX ERROR \u2013 Unable to parse z-action: ${r.message}
`,n,r.stack)}}async function S(e,t,n){try{let r=fe(e);r.event=t;let s=await n(r),o=new CustomEvent("action",{detail:{result:s,event:t}});s&&e.dispatchEvent(o)}catch(r){console.error(`ZJAX ERROR \u2013 Unable to execute z-action: ${r.message}
`,e,r.stack)}}function fe(e){return new Proxy(function(){},{apply(t,n,r){if(r.length===0)return e;if(r.length===1){let s=document.querySelector(r[0]);if(!s)throw new Error(`$('${r[0]}') did not match any elements in the DOM.`);return s}throw new Error("$() can be called with a maximum of one argument.")},get(t,n){if(n==="event")return t.event;if(n==="all")return function(r){return document.querySelectorAll(r)}}})}function de(e,t){let n=e.match(/^(?:(\w+)\.)?(\w+)$/);if(n){let r=n[1],s=n[2],o=zjax&&zjax.userActions;if(r){if(!(o[r]&&o[r][s]))throw new Error(`Unknown action: ${r}.${s}`);return o[r][s].bind(o[r])}else{if(!o[s])throw new Error(`Unknown action: ${s}`);return o[s].bind(o)}}try{return new Function("$",e)}catch(r){throw new Error(`z-action value is invalid: ${r.message}`)}}window.zjax=b();document.addEventListener("DOMContentLoaded",()=>{p("Parsing DOM"),w(document),h(document);let e=Array.isArray(window.zjax.parseOn)?window.zjax.parseOn:[window.zjax.parseOn];for(let t of e)document.addEventListener(t,()=>{p("Reparsing DOM on",t),w(document),h(document)})});})();
